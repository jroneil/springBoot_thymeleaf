<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<body>

    <div th:replace="~{layout :: layout(
        content=~{::content}, 
        pageTitle='Roles',
        infoContent=~{::pageInfo},
        showInfoPanel=true
    )}">
        <!-- Custom Info for this page -->
        <div th:fragment="pageInfo">
            <h3 class="text-lg font-semibold text-blue-400 mb-3">Role Management</h3>
            <p class="text-sm text-gray-400 leading-relaxed mb-4">
                This page demonstrates a complete CRUD interface for managing system roles.
            </p>
            <ul class="space-y-2 text-xs text-gray-500">
                <li class="flex items-center">
                    <svg class="w-4 h-4 mr-2 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                    </svg>
                    Server-side validation
                </li>
                <li class="flex items-center">
                    <svg class="w-4 h-4 mr-2 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                    </svg>
                    PRG Pattern (Post-Redirect-Get)
                </li>
                <li class="flex items-center">
                    <svg class="w-4 h-4 mr-2 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                    </svg>
                    Flash messages for feedback
                </li>
            </ul>
        </div>

        <div th:fragment="content">

            <div class="flex flex-col lg:flex-row justify-between items-start lg:items-end gap-6 mb-8">
                <div class="mb-4 lg:mb-0">
                    <h2 class="text-xl font-semibold text-gray-200" style="margin: 0;">Management</h2>
                    <p class="text-sm text-gray-400 mt-1">Manage and filter system roles</p>
                </div>

                <div class="flex flex-col items-end gap-4 w-full lg:w-auto">
                    <!-- Create Button Above -->
                    <a th:href="@{/roles/new}" class="btn btn-primary"
                        style="white-space: nowrap; display: inline-flex; justify-content: center; align-items: center; width: auto; padding: 0.6rem 1.25rem;">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                        Create Role
                    </a>

                    <!-- Search Form Below -->
                    <form th:action="@{/roles}" method="get" class="flex items-center gap-2 w-full lg:w-auto">
                        <div style="position: relative; flex-grow: 1;">
                            <input type="text" name="search" th:value="${search}" placeholder="Search roles by name..."
                                class="form-input" style="width: 100%; padding-right: 2.5rem; min-width: 360px;">
                            <!-- 240px * 1.5 = 360px -->
                            <button type="submit"
                                style="position: absolute; right: 0.75rem; top: 50%; transform: translateY(-50%); background: transparent; border: none; cursor: pointer; color: var(--color-text-muted); padding: 0; display: flex; align-items: center;">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <circle cx="11" cy="11" r="8"></circle>
                                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                                </svg>
                            </button>
                        </div>
                        <a th:if="${search}" th:href="@{/roles}" class="btn btn-sm"
                            style="background: rgba(255,255,255,0.05); border: 1px solid var(--color-glass-border); color: var(--color-text-muted); white-space: nowrap; height: 100%; display: inline-flex; align-items: center; padding: 0.625rem 1rem;">
                            Reset
                        </a>
                    </form>
                </div>
            </div>

            <div class="overflow-x-auto bg-gray-800 rounded-lg shadow-xl border border-gray-700">
                <table class="w-full text-left border-collapse">
                    <thead>
                        <tr class="bg-gray-700/50">
                            <th class="px-6 py-4 font-semibold text-gray-200">Code</th>
                            <th class="px-6 py-4 font-semibold text-gray-200">Name</th>
                            <th class="px-6 py-4 font-semibold text-gray-200 text-center">Actions</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-700">
                        <tr th:each="role : ${roles}" class="hover:bg-gray-700/30 transition-colors">
                            <td class="px-6 py-4 font-mono text-blue-400" th:text="${role.code}">ROLE_CODE</td>
                            <td class="px-6 py-4">
                                <div class="font-medium text-gray-100" th:text="${role.name}">Role Name</div>
                                <div class="text-xs text-gray-400 mt-1" th:text="${role.description}">Description</div>
                            </td>
                            <td class="px-6 py-4">
                                <div class="flex justify-center space-x-3">
                                    <a th:href="@{/roles/{id}/edit(id=${role.id})}" class="btn btn-sm btn-edit">
                                        Edit
                                    </a>
                                    <form th:action="@{/roles/{id}/delete(id=${role.id})}" method="post"
                                        onsubmit="return confirm('Are you sure you want to delete this role?');"
                                        class="inline">
                                        <button type="submit" class="btn btn-sm btn-danger">Delete</button>
                                    </form>
                                </div>
                            </td>
                        </tr>
                        <tr th:if="${#lists.isEmpty(roles)}">
                            <td colspan="3" class="px-6 py-12 text-center text-gray-500 italic">
                                No roles found. Click "Create Role" to add one.
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

</body>

</html>